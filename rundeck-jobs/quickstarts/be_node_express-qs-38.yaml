- description: |-
    TEST: A node project using Typescript and a minimal express server

    Testing for [Replace upload-templates.sh with tailor · Issue #38 · opendevstack/ods-project-quickstarters](https://github.com/opendevstack/ods-project-quickstarters/issues/38)
  executionEnabled: true
  group: quickstarts
  id: 4bdbb70a-01b1-4483-b85b-17e929061b45
  loglevel: INFO
  name: be_node_express-qs-38
  nodeFilterEditable: false
  options:
  - description: id of the project (i.e. bhw for basic hellow world)
    name: project_id
    required: true
  - description: group id for maven style projects (i.e. org.opendevstack.bhw for bhw project)
    name: group_id
  - description: id of the component to create (i.e. bhw-be for bhw backend)
    name: component_id
    required: true
  - description: git url to access target repository via http
    name: git_url_http
    required: true
  - description: git url to access target repository via ssh
    name: git_url_ssh
    required: true
  - description: name of the source code root package
    name: package_name
  - description: openshift api token to log on to open shift
    name: openshift_api_token
    required: true
    secure: true
    storagePath: keys/openshift-api-token
    valueExposed: true
  scheduleEnabled: true
  sequence:
    commands:
    - exec: 'echo project_id: ${option.project_id},  component_id: ${option.component_id},
        git_url_https: ${option.git_url_https}, git_url_ssh: ${option.git_url_ssh},
        package_name: ${option.package_name}'
    - description: checkout quickstart - origin/task/tailor-for-update-templates
      exec: mkdir /tmp/rundeck_${job.id}_${job.execid} && cd  /tmp/rundeck_${job.id}_${job.execid} && git clone ${globals.bitbucket_sshhost}/opendevstack/ods-project-quickstarters.git && cd ods-project-quickstarters && git checkout origin/task/tailor-for-update-templates
    - description: generate docker container for node express server
      exec: cd /tmp/rundeck_${job.id}_${job.execid}/ods-project-quickstarters/boilerplates/be-node-express && ./build.sh --registry ${globals.openshift_dockerregistry} --user ${globals.openshift_user} --token ${option.openshift_api_token}
    - description: init node express project
      exec: cd /tmp/rundeck_${job.id}_${job.execid}/ods-project-quickstarters/boilerplates/be-node-express && ./init.sh --project "${option.project_id}" --component "${option.component_id}" --group "${option.group_id}" --target-dir "/tmp/rundeck_${job.id}_${job.execid}" --owner "${globals.rundeck_os_user}"
    - description: setup quickstarter for continuous integration
      jobref:
        args: -component_type be-node-express -component_id ${option.component_id} -project_id ${option.project_id} -quickstarter_directory /tmp/rundeck_${job.id}_${job.execid}/${option.component_id} -git_url_ssh ${option.git_url_ssh} -git_url_http ${option.git_url_http}
        group: common
        name: prepare-continuous-integration-qs-38
        nodeStep: 'true'
    keepgoing: false
    strategy: node-first
  uuid: 4bdbb70a-01b1-4483-b85b-17e929061b45